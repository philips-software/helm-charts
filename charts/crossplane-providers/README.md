# crossplane-providers

![Version: 0.0.25](https://img.shields.io/badge/Version-0.0.25-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: v2.3.0](https://img.shields.io/badge/AppVersion-v2.3.0-informational?style=flat-square)

## Overview

This Helm chart is designed for deploying Crossplane family providers in environments where cloud resources are split across multiple provider packages. It simplifies the management of provider configurations for multi-cloud scenarios, particularly when working with AWS, GCP, and other cloud provider packages that form the Crossplane ecosystem.

The chart enables you to:
- Deploy multiple Crossplane providers simultaneously
- Configure provider-specific settings and authentication
- Manage IAM roles and permissions required by different cloud providers
- Standardize provider deployment across environments

# Deployment

This chart can be deployed using Kustomize and ArgoCD for GitOps-based continuous deployment.

## Kustomize Deployment

Create a `kustomization.yaml` file:

```yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

helmCharts:
  - name: crossplane-providers
    repo: https://philips-software.github.io/helm-charts
    version: "0.0.25"
    releaseName: crossplane-providers
    namespace: crossplane-system
    valuesFile: values.yaml
```

Then deploy with:
```bash
kubectl apply -k .
```

## ArgoCD Application

Create an ArgoCD Application manifest:

```yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: crossplane-providers
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://philips-software.github.io/helm-charts
    chart: crossplane-providers
    targetRevision: "0.0.25"
    helm:
      valueFiles:
        - values.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: crossplane-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
```

## Prerequisites

- Crossplane must be installed in the cluster
- Ensure the `crossplane-system` namespace exists
- Configure appropriate RBAC permissions for provider operations

## Dependencies

The application uses [Crossplane](https://www.crossplane.io) to manage the required IAM roles

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| environmentConfig.accountId | string | `""` |  |
| environmentConfig.oidcProvider | string | `""` |  |
| environmentConfig.oidcProviderArn | string | `""` |  |
| environmentConfig.resourcePrefix | string | `""` |  |
| extraProviders | list | `[]` |  |
| package.namespace | string | `"crossplane-system"` |  |
| package.registry | string | `"xpkg.crossplane.io/crossplane-contrib"` |  |
| package.version | string | `"v2.3.0"` |  |
| providers[0].enabled | bool | `true` |  |
| providers[0].name | string | `"provider-family-aws"` |  |
| providers[1].enabled | bool | `true` |  |
| providers[1].managedPolicyArns[0] | string | `"arn:aws:iam::aws:policy/AmazonS3FullAccess"` |  |
| providers[1].name | string | `"provider-aws-s3"` |  |
| providers[1].resources.limits.memory | string | `"640Mi"` |  |
| providers[1].resources.requests.cpu | string | `"40m"` |  |
| providers[1].resources.requests.memory | string | `"320Mi"` |  |
| providers[2].enabled | bool | `true` |  |
| providers[2].managedPolicyArns[0] | string | `"arn:aws:iam::aws:policy/AmazonRDSFullAccess"` |  |
| providers[2].name | string | `"provider-aws-rds"` |  |
| providers[3].enabled | bool | `true` |  |
| providers[3].name | string | `"provider-aws-kms"` |  |
| providers[3].policy | string | `"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:UntagResource\",\n        \"kms:TagResource\",\n        \"kms:ScheduleKeyDeletion\",\n        \"kms:ListRetirableGrants\",\n        \"kms:ListKeys\",\n        \"kms:ListAliases\",\n        \"kms:List*\",\n        \"kms:Get*\",\n        \"kms:GenerateRandom\",\n        \"kms:DescribeCustomKeyStores\",\n        \"kms:Describe*\",\n        \"kms:DeleteAlias\",\n        \"kms:CreateKey\",\n        \"kms:CreateAlias\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n"` |  |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.14.2](https://github.com/norwoodj/helm-docs/releases/v1.14.2)
